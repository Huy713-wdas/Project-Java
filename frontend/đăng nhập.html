<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>Carbon Credit Marketplace for EV Owners</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        body {
            font-family: 'Segoe UI', Roboto, Arial;
            margin: 0;
            padding: 5px;
            background: url('https://tapchinganhang.gov.vn/stores/news_dataimages/2025/062025/30/17/carbon-credit-589920250630172437.jpg?rt=20250630172438://vietnamblockchain.asia/wp-content/uploads/2024/02/CC_1@4x-768x342.png') no-repeat center center;
background-size: cover ;

            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .card {
            width: 440px;
            background: #fff;
            border-radius: 16px;
            padding: 28px 32px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.25);
            animation: fadeIn 0.6s ease;
        }
        @keyframes fadeIn {
            from {opacity:0; transform: translateY(20px);}
            to {opacity:1; transform: translateY(0);}
        }
        .logo {
            text-align: center;
            margin-bottom: 12px;
        }
        .logo img {
            width: 90px;
            height: auto;
        }
        h1 {
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            color: #06b26e;
            margin-bottom: 18px;
        }
        .tabs {
            display: flex;
            gap: 8px;
            background: #e6f5ec;
            padding: 6px;
            border-radius: 20px;
            margin-bottom: 22px;
        }
        .tabs button {
            flex: 1;
            padding: 10px 14px;
            border-radius: 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            color: #333;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .tabs button.active {
            background: #06b26e;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        h2 {
            margin: 6px 0 18px 0;
            font-weight: 600;
            color: #222;
            text-align: center;
        }
        .input-group {
            position: relative;
            margin-top: 12px;
        }
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #dce3eb;
            border-radius: 10px;
            font-size: 14px;
            transition: border 0.3s ease;
        }
        .input-group input:focus {
            border-color: #06b26e;
            outline: none;
            box-shadow: 0 0 0 3px rgba(6,178,110,0.15);
        }
        .submit {
            margin-top: 22px;
            width: 100%;
            padding: 14px;
            background: linear-gradient(90deg,#06b26e,#059e63);
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(6,178,110,0.3);
        }
        .muted {
            color: #6b7280;
            font-size: 13px;
            text-align: center;
            margin-top: 16px;
        }
        a.sign {
            color: #06b26e;
            font-weight: 600;
            text-decoration: none;
        }
        a.sign:hover {
            text-decoration: underline;
        }
        .msg {
            margin-top: 12px;
            color: #b00020;
            min-height: 18px;
            text-align: center;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="card">
        <div class="logo">
            <!-- Logo xe điện -->
            <img src="https://media-cdn-v2.laodong.vn/storage/newsportal/2025/11/2/1602272/Z7180389705469_7Deef.jpg?w=660" alt="Xe điện">
        </div>
        <h1>Carbon Credit Marketplace for EV Owners</h1>
        <div class="tabs" role="tablist">
            <button id="tabUser" class="active" aria-pressed="true">Người dùng / Chủ xe điện</button>
            <button id="tabAdmin" aria-pressed="false">Quản trị / CVA</button>
        </div>

        <div id="formArea">
            <h2 id="formTitle">Đăng nhập Người dùng</h2>

            <form id="loginForm">
                <input type="hidden" name="role" id="roleInput" value="user">
                <div class="input-group">
                    <input type="email" name="email" required placeholder="email@gmail.com">
                </div>
                <div class="input-group">
                    <input type="password" name="password" required placeholder="●●●●●●●">
                </div>

                <button type="submit" id="submitBtn" class="submit">Đăng nhập Người dùng</button>
            </form>

            <div id="result" class="msg"></div>

        <div id="signupArea" class="muted">Chưa có tài khoản? <a class="sign" href="/đăng ký.html">Đăng ký</a></div>
  </div>

  <script>
    const tabUser=document.getElementById('tabUser');
    const tabAdmin=document.getElementById('tabAdmin');
    const roleInput=document.getElementById('roleInput');
    const formTitle=document.getElementById('formTitle');
    const submitBtn=document.getElementById('submitBtn');
    const signupArea=document.getElementById('signupArea');
    const result=document.getElementById('result');

    function showUser(){
      tabUser.classList.add('active');tabAdmin.classList.remove('active');
      roleInput.value='user';formTitle.textContent='Đăng nhập Người dùng';
      submitBtn.textContent='Đăng nhập Người dùng';signupArea.style.display='block';result.textContent='';
    }
    function showAdmin(){
      tabAdmin.classList.add('active');tabUser.classList.remove('active');
      roleInput.value='admin';formTitle.textContent='Đăng nhập Quản trị';
      submitBtn.textContent='Đăng nhập Quản trị';signupArea.style.display='none';result.textContent='';
    }

        tabUser.addEventListener('click', showUser);
        tabAdmin.addEventListener('click', showAdmin);

        const form = document.getElementById('loginForm');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            result.textContent = '';
            const data = Object.fromEntries(new FormData(form).entries());
           const endpoint = data.role === 'admin' ? '/api/admin/register' : '/api/users/register';

const res = await fetch(endpoint, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
        email: data.email,
        password: data.password,
        fullName: data.fullName
    })
});

            try {
                const res = await fetch(endpoint, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({email: data.email, password: data.password})
                });
                const json = await res.json().catch(() => null);
                if (res.ok) {
                    window.location.href = '/';
                } else {
                    result.textContent = json && json.message ? json.message : (json ? JSON.stringify(json) : 'Đăng nhập thất bại');
                }
            } catch (err) {
                result.textContent = 'Lỗi: ' + err;
            }
        });
    </script>
</body>
</html>
